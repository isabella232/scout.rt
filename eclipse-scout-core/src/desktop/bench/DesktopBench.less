/*
 * Copyright (c) 2014-2018 BSI Business Systems Integration AG.
 * All rights reserved. This program and the accompanying materials
 * are made available under the terms of the Eclipse Public License v1.0
 * which accompanies this distribution, and is available at
 * http://www.eclipse.org/legal/epl-v10.html
 *
 * Contributors:
 *     BSI Business Systems Integration AG - initial API and implementation
 */
.desktop-bench-drop-shadow() {
  content: '';
  position: absolute;
  top: @desktop-bench-drop-shadow-top;
  left: 0;
  width: 10px;
  height: calc(~'100% - ' @desktop-bench-drop-shadow-top);
  box-shadow: -8px 0 10px 0 rgba(0, 0, 0, 0.1);
  clip-path: polygon(-100% 0, 200% 0, 200% 200%, -100% 200%);
}

.desktop-bench {
  position: absolute;
  top: 0;
  background-color: @desktop-bench-background-color;

  &.drop-shadow {
    .desktop-bench-drop-shadow();
    .desktop:not(.first-tab-selected) > & {
      border-top-left-radius: @desktop-bench-border-top-left-radius;
      overflow: hidden;
    }
  }

  &.animate-remove {
    #scout.animation-name(slideout-right);
    #scout.animation-duration(0.5s);
  }

  /* Make some space for the navigation handle (when the navigation is closed */
  /* Only do it if detail-table is at the bottom left corner */

  &.has-navigation-handle > .bench-column.first > .view-tab-box.last > .tab-content > .detail-table > .table-footer > .table-controls {
    margin-left: 25px;

    & > .table-control.selected {
      border-left-color: @border-color;
    }
  }

  & > .splitter.x-axis {
    margin-left: -7px;
    margin-right: -7px;
  }
}

.desktop-bench:not(.drop-shadow) > .bench-column > .view-tab-box > .tab-content > .form { // TODO CGU brushup make it simpler
  background-color: @detail-form-background-color;
}

.detail-table.table {
  background-color: @detail-table-background-color;

  & > .group-box,
  & > .accordion {
    background-color: @desktop-bench-background-color;
  }

  // TODO CGU brushup background-color necessary because of -1px margin, aggregate rows draw over header
  // maybe remove top margin/padding 1px and selected row margin 1px

  &.loading {
    & > .loading-indicator {
      #scout.loading-indicator(@busyindicator-large-size, @busyindicator-large-border-width);
    }
  }

  &.ie {
    // Workaround for bug #227039. Focus calls come too early when table is not correctly layouted yet
    // -> if table is big ie tries to scroll which leads to ugly flickering and moved desktop whenever a large page with table is clicked
    height: 0;
    width: 0;
  }

  & > .table-header {
    padding-left: @detail-table-header-padding-x;
    padding-right: @detail-table-header-padding-x;
    background-color: @detail-table-header-background-color;

    & > .table-header-item {
      padding-top: @detail-table-header-padding-y;
      padding-bottom: @detail-table-header-padding-y;

      & > .table-header-item-state {
        top: 11px; // TODO CGU use flex?
      }
    }

    & > .menubar-container {
      padding-left: 6px;
      padding-right: @detail-table-header-menubar-padding-right;

      & > .menubar > .menubox > .menu-item {
        margin-right: 12px;
      }
    }
  }

  & > .table-data {
    padding-left: @detail-table-data-padding-x;
    padding-right: @detail-table-data-padding-x;
  }

  & > .table-footer {
    background-color: @detail-table-footer-background-color;
  }

  & .table-aggregate {
    /* Desktop table has a 2px (left) border. */
    margin-left: @detail-table-data-padding-x + 2px;

    & > .table-cell {
      padding-top: @detail-table-row-padding-y;
      padding-bottom: @detail-table-row-padding-y;
    }
  }

  & > .table-data {
    & > .scrollbar {
      #scout.scrollbar-x-padding(4px, 2px);
    }

    & > .table-row,
    & > .table-aggregate-row {
      /* Desktop table has a 2px border. Top and bottom border are added to the table cell. */
      border-left-width: @detail-table-selection-border-extra-width + 1px;
      border-right-width: @detail-table-selection-border-extra-width + 1px;
      border-radius: @detail-table-border-radius;

      &.selected {
        background-color: @item-selection-background-color;
        border-color: @item-selection-border-color;
      }

      & > .table-cell {
        /* Replace first and last pixel of specified row padding by a transparent border. This border will be */
        /* set to the selection color when the row is selected, thus creating the illusion that the 2px selection */
        /* border is drawn around the cell. See CSS rules below. */
        padding-top: @detail-table-row-padding-y - @detail-table-selection-border-extra-width;
        padding-bottom: @detail-table-row-padding-y - @detail-table-selection-border-extra-width;
        border-top: @detail-table-selection-border-extra-width solid transparent;
        border-bottom: @detail-table-selection-border-extra-width solid transparent;

        &.checkable {
          padding-top: @detail-table-row-padding-y - @checkable-cell-padding-adjustment - @detail-table-selection-border-extra-width;
          padding-bottom: 0;
        }

        & > .table-row-control {
          padding-top: @detail-table-row-padding-y - @detail-table-selection-border-extra-width;
          padding-bottom: @detail-table-row-padding-y - @detail-table-selection-border-extra-width;
        }
      }

      &.select-top > .table-cell {
        border-top-color: @item-selection-border-color;
      }

      &.select-bottom > .table-cell {
        border-bottom-color: @item-selection-border-color;
      }

      &.select-single > .table-cell {
        border-top-color: @item-selection-border-color;
        border-bottom-color: @item-selection-border-color;
      }
    }

    & > .cell-editor-popup > .check-box-field {
      border-top: 2px solid @item-selection-border-color;
      border-bottom: 2px solid @item-selection-border-color;

      & > .field {
        padding-top: @detail-table-row-padding-y - @checkable-cell-padding-adjustment - 1px;
      }
    }

    & > .cell-editor-popup > .cell-editor-form-field > input,
    & > .cell-editor-popup > .cell-editor-form-field > .field > input {
      border-top: 2px solid @item-selection-border-color;
      border-bottom: 2px solid @item-selection-border-color;
    }
  }
}

@media only screen and(min-resolution: 96.96dpi) {
  /* 1.01dppx / 101% */
  /* The browser may not display the 2px border properly when zoomed, it draws a white gap between the cell and the row border.
     To prevent that the border is reduced to the simple 1px border. This is also applied if windows font size is set to medium (125%) */
  .detail-table.table {

    & > .table-data {

      & > .table-row,
      & > .table-aggregate-row {
        border-left-width: 1px;
        border-right-width: 1px;

        &.select-top > .table-cell {
          border-top-color: transparent;
        }

        &.select-bottom > .table-cell {
          border-bottom-color: transparent;
        }

        &.select-single > .table-cell {
          border-top-color: transparent;
          border-bottom-color: transparent;
        }
      }
    }
  }
}
